{"version":3,"sources":["../../../src/components/autocomplete/index.tsx","../../../src/util/tailwind-util/class-names/index.ts"],"sourcesContent":["import { Combobox, Transition } from \"@headlessui/react\";\nimport { CheckIcon, ChevronUpDownIcon } from \"@heroicons/react/20/solid\";\nimport { classNames } from \"@taling-ui/util/tailwind-util/class-names\";\nimport { Fragment, useEffect, useState } from \"react\";\n\nexport interface IAutocompleteItem {\n  id: number;\n  name: string;\n  children?: IAutocompleteChild[];\n  isAvailable: boolean;\n}\n\nexport interface IAutocompleteChild {\n  id: number;\n  name: string;\n  parentId: number;\n  [key: string]: any;\n}\n\nexport interface ParsedItemType {\n  id: string;\n  name: string;\n  children?: ParsedItemType[] | null;\n  parentId?: number;\n  isAvailable?: boolean;\n}\n\ninterface AutoCompleteProps {\n  defaultSelection: IAutocompleteItem | IAutocompleteChild | null;\n  list: IAutocompleteItem[];\n  onSelected: (item: ParsedItemType | null) => void;\n  rounded?: \"sm\" | \"md\" | \"lg\";\n  enabled?: boolean;\n}\n\nexport default function Autocomplete({\n  defaultSelection,\n  list,\n  onSelected,\n  rounded = \"md\",\n  enabled = true,\n}: AutoCompleteProps) {\n  const [selected, setSelected] = useState<ParsedItemType | null>(null);\n  const [search, setSearch] = useState(\"\");\n\n  const checkSearch = (item: string, searchVal: string) => {\n    return item\n      .toLowerCase()\n      .replace(/\\s+/g, \"\")\n      .includes(searchVal.toLowerCase().replace(/\\s+/g, \"\"));\n  };\n\n  const parsedList = list.map((item) => {\n    return {\n      id: \"p\" + item.id,\n      name: item.name,\n      children: item.children\n        ? item.children.map((child) => ({\n            id: \"c\" + child.id,\n            name: child.name,\n            parentId: child.parentId,\n          }))\n        : null,\n      isAvailable: item.isAvailable,\n    };\n  });\n\n  const filteredList =\n    search === \"\"\n      ? parsedList\n      : parsedList.reduce(\n          (searchResult: ParsedItemType[], parent: ParsedItemType) => {\n            if (checkSearch(parent.name, search)) searchResult.push(parent);\n            else {\n              const childResult = parent.children?.filter((child) =>\n                checkSearch(child.name, search)\n              );\n              if (childResult && childResult.length > 0) {\n                searchResult.push(parent);\n              }\n            }\n            return searchResult;\n          },\n          []\n        );\n\n  useEffect(() => {\n    if (defaultSelection) {\n      const parsedDefaultSelection = {\n        ...defaultSelection,\n        id: Object.prototype.hasOwnProperty.call(defaultSelection, \"parentId\")\n          ? \"c\" + defaultSelection.id\n          : \"p\" + defaultSelection.id,\n      } as ParsedItemType;\n      setSelected(parsedDefaultSelection);\n    }\n  }, [defaultSelection]);\n\n  return (\n    <Combobox\n      value={selected}\n      by=\"id\"\n      onChange={(value) => {\n        if (value === null) return;\n        setSelected(value);\n        const parsedValue = {\n          id: value.id.slice(1),\n          name: value.name,\n          ...(Object.prototype.hasOwnProperty.call(value, \"parentId\") && {\n            parentId: value.parentId,\n          }),\n        };\n\n        onSelected(parsedValue);\n      }}\n      disabled={!enabled}\n    >\n      <div className=\"relative z-30\">\n        <div\n          className={classNames(\n            \"relative w-full cursor-default bg-white text-left shadow-sm\"\n          )}\n        >\n          <Combobox.Input\n            className={classNames(\n              \"w-full border-none py-1.5 pl-3 pr-10 text-sm leading-5 text-taling-gray-900 ring-1 ring-inset ring-gray-300 sm:text-sm sm:leading-6\",\n              enabled\n                ? \"focus:outline-none focus:ring-2 focus:ring-taling-pink\"\n                : \"!cursor-not-allowed !bg-taling-gray-300 !text-taling-gray-800 opacity-50 \",\n              round(rounded)\n            )}\n            displayValue={(item: ParsedItemType | null) => item?.name || \"\"}\n            onChange={(e) => setSearch(e.target.value)}\n            placeholder=\"카테고리를 검색해 주세요.\"\n          />\n          <Combobox.Button\n            className={classNames(\n              \"absolute inset-y-0 right-0 flex items-center pr-2\",\n              enabled ? \"\" : \"!cursor-not-allowed\"\n            )}\n          >\n            <ChevronUpDownIcon\n              className=\"h-5 w-5 text-gray-400\"\n              aria-hidden=\"true\"\n            />\n          </Combobox.Button>\n        </div>\n        <Transition\n          as={Fragment}\n          leave=\"transition ease-in duration-100\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n          afterLeave={() => setSearch(\"\")}\n        >\n          <Combobox.Options\n            className={classNames(\n              \"absolute z-10 mt-1 max-h-60 w-full overflow-auto bg-white py-1 text-base shadow-lg ring-1 ring-black/5 focus:outline-none sm:text-sm\",\n              round(rounded)\n            )}\n          >\n            {filteredList.length === 0 && search !== \"\" ? (\n              <div className=\"taling-gray-900 relative cursor-default select-none px-4 py-2\">\n                검색 결과가 없습니다.\n              </div>\n            ) : (\n              filteredList.map((parent) => (\n                <Combobox.Option\n                  key={parent.id}\n                  className={({ selected, active }) =>\n                    classNames(\n                      \"relative cursor-default select-none pl-5 text-taling-gray-900\",\n                      active || selected ? \"bg-taling-gray-100\" : \"\"\n                    )\n                  }\n                  disabled={!parent.isAvailable}\n                  value={parent}\n                >\n                  {({ selected }) => (\n                    <>\n                      <span\n                        className={classNames(\n                          \"block truncate pb-1 pt-2\",\n                          parent.children\n                            ? \"font-bold text-taling-gray-700\"\n                            : \"font-normal\"\n                        )}\n                      >\n                        {parent.name}\n                      </span>\n                      {selected ? (\n                        <span\n                          className={`absolute left-0 top-1.5 flex items-center text-taling-pink`}\n                        >\n                          <CheckIcon className=\"h-5 w-5\" aria-hidden=\"true\" />\n                        </span>\n                      ) : null}\n                      {parent.children && (\n                        <ul>\n                          {parent.children.map((child) => (\n                            <Combobox.Option\n                              key={child.id}\n                              className={({ selected, active }) =>\n                                classNames(\n                                  \"relative -ml-5 cursor-pointer select-none py-2 pl-8 pr-4 text-taling-gray-900\",\n                                  active || selected ? \"bg-taling-gray-100\" : \"\"\n                                )\n                              }\n                              value={child}\n                            >\n                              {({ selected }) => (\n                                <>\n                                  <span className={\"block truncate\"}>\n                                    {child.name}\n                                  </span>\n                                  {selected ? (\n                                    <span\n                                      className={`absolute inset-y-0 left-2 flex items-center text-taling-pink`}\n                                    >\n                                      <CheckIcon\n                                        className=\"h-5 w-5\"\n                                        aria-hidden=\"true\"\n                                      />\n                                    </span>\n                                  ) : null}\n                                </>\n                              )}\n                            </Combobox.Option>\n                          ))}\n                        </ul>\n                      )}\n                    </>\n                  )}\n                </Combobox.Option>\n              ))\n            )}\n          </Combobox.Options>\n        </Transition>\n      </div>\n    </Combobox>\n  );\n}\n\nfunction round(rounded: \"sm\" | \"md\" | \"lg\") {\n  switch (rounded) {\n    case \"sm\":\n      return \"rounded\";\n    case \"md\":\n      return \"rounded-md\";\n    case \"lg\":\n      return \"rounded-lg\";\n  }\n}\n","export function classNames(...classes: (string | undefined)[]) {\n  return classes.filter(Boolean).join(\" \");\n}\n"],"mappings":"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","names":["import_react","selected"]}